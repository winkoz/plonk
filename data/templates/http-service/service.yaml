apiVersion: v1
kind: Service
metadata:
  name: {{.NAME}}-{{.ENV}}-service
  namespace: {{.NAME}}-{{.ENV}}
  labels:
    app: {{.NAME}}-{{.ENV}}
    component: {{.COMPONENT}}
  {{if (eq .PROMETHEUS_METRICS_ENABLED "true")}}
  annotations:
    prometheus.io/scrape: "true"
    prometheus.io/scheme: "http"
    prometheus.io/path: "/metrics"
    prometheus.io/port: "{{.CONTAINER_PORT}}"
  {{end}}
spec:
  type: ClusterIP
  ports:
  - port: {{.SERVICE_PORT}}
    targetPort: {{.CONTAINER_PORT}}
  selector:
    app: {{.NAME}}-{{.ENV}}
    component: {{.COMPONENT}}
