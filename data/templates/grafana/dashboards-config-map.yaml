{{if .DASHBOARDS}}
{{range $idx, $dashboardMap := .DASHBOARDS | yamlArrayToObj}}
apiVersion: v1
kind: ConfigMap
metadata:
  namespace: {{$.NAME}}-{{$.ENV}}
  name: {{$.NAME}}-{{$.ENV}}-dashboards-config-map
  labels:
    app: {{$.NAME}}-{{$.ENV}}
    component: grafana
    dashboard-provider: {{$dashboardMap.provider}}
data:
  {{$dashboardMap.filename}}:
    |-
      {{indent ($dashboardMap.filename | readFileToStr) 6}}
---
{{end}}
{{end}}