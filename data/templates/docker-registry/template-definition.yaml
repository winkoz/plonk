name: docker-registry
variables: 
  build:
    COMPONENT: docker-registry
    DOCKER_IMAGE: 'registry:2.7.1'
    SERVICE_PORT: 80
    CONTAINER_PORT: 5000
    REPLICAS: 1
    PVC_ACCESS_MODE: ReadWriteOnce
    PVC_STORAGE_SIZE: 5Gi
    PVC_STORAGE_CLASS_NAME: do-block-storage
    IMAGE_PULLPOLICY: IfNotPresent
    PROBE_SCHEME: HTTP
    DOCKER_CONFIG_PATH: ~/.docker/config.json
    REGISTRY_HTPASSWD_PATH: ./auth
    USE_WILDCARD_TLS_CERTIFICATE: false
  environment:
    PORT: 5000
    REGISTRY_STORAGE_FILESYSTEM_ROOTDIRECTORY: /var/lib/registry
    REGISTRY_STORAGE_DELETE_ENABLED: true
    REGISTRY_AUTH: htpasswd
    REGISTRY_AUTH_HTPASSWD_REALM: 'Registry Realm'
    REGISTRY_AUTH_HTPASSWD_PATH: '/auth/htpasswd'
  secret:
    REGISTRY_SECRET: NOT_DEFINED
manifests:
  - secret.yaml
  - secret-imgpull.yaml
  - pvc.yaml
  - service.yaml
  - deployment.yaml
  - ingress.yaml
